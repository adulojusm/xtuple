language: c

before_install:
  - rm -rf ~/.nvm
  - wget git.io/hikK5g -qO- | sudo bash
  - n latest
  - npm install xtuple-server -g
  - n stable

install:
  - npm install
  - sudo xtuple-server install-dev --xt-demo --pg-worldlogin

before_script:
  - npm run test-build
  - npm start &
  - sleep 10

script:
  - npm test
  - npm run test-datasource
  - npm run jshint

after_failure:
  - env
  - cat test/lib/login_data.json
  - cat node-datasource/config.js
  - cat npm-debug.log
